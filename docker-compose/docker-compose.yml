---
version: '2.2'
services:
  code-server:
    image: codercom/code-server:latest
    command:
    - --disable-telemetry
    # with server certificate and key
    #- --cert=/server.crt
    #- --cert-key=/server.key
    # for local access
    #- --allow-http --no-auth
    ports:
    - 8443:8443
    # for local access
    #- 127.0.0.1:8080:8443
    volumes:
    - "${PWD}/coder:/home/coder:rw"
    - "${PWD}/etc/sudoers.d/code-server:/etc/sudoers.d/code-server:ro"
    - "${PWD}/opt:/opt:rw"
    # comment out if you don't use the SSH protocol to access GitHub,...
    - "${SSH_AUTH_SOCK:-/tmp/ssh-coder/agent.dummy}:/ssh-agent:rw"
    - "/var/run/docker.sock:/var/run/docker.sock:rw"
    # with server certificate and key
    #- "/path/to/server.crt:/server.crt:ro"
    #- "/path/to/server.key:/server.key:ro"
    environment:
      # ICU
      LD_LIBRARY_PATH: /opt/icu/lib
      # Optware-ng, .Net
      PATH: '${PATH}:/opt/bin:/opt/sbin:/opt/dotnet:/home/coder/dotnet'
      SSH_AUTH_SOCK: /ssh-agent
